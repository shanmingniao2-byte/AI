<!DOCTYPE html >
< html lang = “en” > 
  <头>
    < meta charset = “utf-8” /> 
    < meta name = “viewport” content = “width=device-width，initial-scale=1” />  
    < title > AI 提示增强器</ title >
    < link rel = “样式表” href = “https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap” />  
    < link rel = “样式表” href = “{{url_for（'static'，filename ='css / style.css'）}}” />  
  </头>
  <正文>
    < div class = “页面” > 
      <标题>
        < h1 > AI提示增强器</ h1 >
        < p >优化提示词、扩写场景关键词，并提供多语言互译矩阵，助力图像创作</ p >
      </ header >
      <主要>
        <部分类= “面板” > 
          <表单ID = “提示表单” > 
            < label for = "prompt" >输入原始提示词</ label > 
            < textarea id = "prompt" name = "prompt" rows = "6" placeholder = "例如：日落时分霓虹灯下的赛博朋克肖像" > </ textarea >    

            < label for = "creativity" >扩写创造力< span id = "creativity-value" > 0.5 </ span > </ label >  
            <输入类型= “范围” id = “创造力”名称= “创造力”最小值= “0”最大值= “1”步长= “0.1”值= “0.5” />       

            <字段集>
              < legend >互译涉及语言</ legend >
              {% 语言中的 lang %}
              <标签类= “复选框” > 
                <输入类型= “复选框”名称= “语言”值= “{{lang.code}}”已选中/>    
                < span > {{ lang.label }} </ span >
              </标签>
              {% 结束 %}
            </字段集>

            < div class = “操作按钮” > 
              < button type = "submit" id = "generate-button" >生成增强提示词</ button >  
              <按钮类型= “按钮” id = “展开按钮” class = “辅助” >   
                提示词扩写
              </按钮>
              <按钮类型= “按钮” id = “翻译按钮” class = “辅助” >   
                多语言互译
              </按钮>
            </div>​​
          </表单>
        </节>

        <部分类= “面板” id = “结果”隐藏>   
          < h2 >分析结果</ h2 >
          < div class = “结果块” > 
            < h3 >检测语言</ h3 >
            < p id = “检测到的语言” > </ p > 
          </div>​​
          < div class = “结果块” > 
            < h3 >优化后的提示词</ h3 >
            < p id = “优化” > </ p > 
          </div>​​
          < div class = “结果块” > 
            < h3 >关键词</ h3 >
            < ul id = “关键字” > </ul> 
          </div>​​
          < div class = “结果块” > 
            < h3 >提示词扩写（场景关键词）</ h3 >
            < p id = “expanded” > </ p > 
          </div>​​
          < div class = “结果块” > 
            < h3 >多语言互译</ h3 >
            < div id = “翻译” > </ div > 
          </div>​​
          < div class = “result-block” id = “建议”隐藏>   
            < h3 >推荐修饰词</ h3 >
          </div>​​
        </节>
      </主要>
    </div>​​

    <脚本>
      const form = document.getElementById ( “提示表单” )
 ;
      const resultPanel = document.getElementById ( "结果" ) ;
      constdetectedLanguageEl = document.getElementById ( “检测到的语言” );
      const optimizedEl = document.getElementById ( "优化" ) ;
      const keywordsEl = document.getElementById ( "关键词" ) ;
      const expandedEl = document.getElementById ( "expanded" ) ;
      const translationsEl = document.getElementById ( "翻译" ) ;
      const suggestionsEl = document.getElementById ( "建议" )
 ;
      const expandButton = document.getElementById ( "expand-button " )
 ;
      const translateButton = document.getElementById ( "翻译按钮" )
 ;
      const creativityInput = document.getElementById ( “创造力” ) ;
      const creativeValue = document.getElementById ( "creativity-value " ) ;

      创造力输入.addEventListener （“输入” ，（）=> {
        创造力值.文本内容= 创造力输入.值；
      });

      expandButton.addEventListener ( “点击” ，异步()=>
 {
        const payload = collectFormValues ();
        const响应 =等待获取（“/api/expand” ，{
 
          方法: "POST" ,
          标头：{ “Content-Type” ：“application/json” }，
          body ：JSON.stringify （有效负载
），
        });
        const数据 =等待响应。json ()
 ；
        确保结果面板（）；
        更新核心部分（数据）；
        更新翻译（{}）；
      });

      translateButton.addEventListener ( “点击” ，异步( )=>{
        const payload = collectFormValues ();
        const响应 =等待获取（“/api/translate” ，{
 
          方法: "POST" ,
          标头：{ “Content-Type” ：“application/json” }，
          body ：JSON.stringify （有效负载
），
        });
        const数据 =等待响应。json ()
 ；
        确保结果面板（）；
        更新核心部分（数据）；
        更新翻译（数据。翻译|| {}）；
      });

      form.addEventListener ( “提交” ，异步(事件)=>{
        事件.preventDefault ( );
        const payload = collectFormValues ();
        const响应 =等待获取（“/api/process” ，{
 
          方法: "POST" ,
          标头：{ “Content-Type” ：“application/json” }，
          body ：JSON.stringify （有效负载
），
        });

        const数据 =等待响应。json ()
 ；
        渲染结果（数据）；
      });

      函数collectFormValues ( ) {
 
        const formData = new FormData (表单);
 
        const prompt = formData.get ( “提示” ) ;
        const创造力 = formData.get ( “创造力” ) ;
        const languages = formData.getAll ( "语言" ) ;
        返回{ 提示，创造力，语言 }；
      }

      函数渲染结果（数据）{
 
        确保结果面板（）；
        更新核心部分（数据）；
        更新翻译（数据。翻译|| {}）；
      }

      函数确保结果面板（）{
 
        结果面板。隐藏=假；
      }

      函数updateCoreSections (数据) {
 
        constdetectedCode = data.detected_language_code
          ？数据。检测到的语言代码。toUpperCase （）
          ：”” ；
        检测到的语言El。文本内容= 检测到的代码
          ` $ {data.detected_language} ( ${detectedCode} )`
          ：数据。检测到的语言|| “-” ；
        优化的El.文本内容= 数据.优化的提示符|| “-” ；
        关键字El.innerHTML = "" ;
        (数据.关键词|| []). forEach ( (单词) => {
          const li = document.createElement ( "li " ) ;
          li.文本内容=单词;
          关键字El.appendChild (li);
        });
        expandedEl.textContent = 数据.expanded_prompt || “ -” ；

        const建议 = 数据。建议|| {};
        建议El。内部HTML = “” ;
        如果（对象.键（建议）.长度）{
          suggestionsEl.hidden = false ;
​
          对象.条目（建议）.forEach （（[类别，选项] ）=> {
            const block = document.createElement ( "div " ) ;
            block.className = "建议类别" ;
            块。innerHTML = ` <h4> ${category} </h4>` ；
            const list = document.createElement ( "ul " ) ;
            选项.forEach ( (项目) => {
              const li = document.createElement ( "li " ) ;
              li.文本内容= 项目
；
              列表.appendChild ( li);
            });
            block.appendChild （列表）
 ；
            suggestionsEl.appendChild (块)
 ;
          });
        }别的{
          suggestionsEl.hidden = true ;​
        }
      }

      函数更新翻译（翻译条目）{
 
        翻译El.内部HTML = “” ;
        如果（！对象.键（translationEntries）.长度）{
          const empty = document.createElement ( "p " ) ;
          空的。className = “empty-hint ”
 ；
          empty. textContent = "请选择至少一种语言以查看互译结果。" ;
          translationsEl.appendChild （空）
 ；
          返回;
        }

        对象.entries （translationEntries）.forEach （（[ code，entry] ）=> {
          const block = document.createElement ( "div " ) ;
块          。className = “翻译矩阵” ；

          const heading = document.createElement ( "div " ) ;
标题          。className = “翻译标题” ；
          标题。innerHTML = ` <strong> ${entry.label} </strong> <span class="tag"> ${code.toUpperCase()} </span>` ；
          block.appendChild （标题）；

          const base = document.createElement ( “p ” ) ;
          base.className = "translation-base "
 ;
          base.textContent = entry.base_text || “ - ” ;
          block.appendChild （基类）
 ；

          const mutual = entry. mutual || {};
          如果（对象.键（相互）.长度）{
            const list = document.createElement ( "ul " ) ;
列表            。className = “翻译目标” ；
            对象.条目（相互）.forEach （（[targetCode，text] ）=> {
              const li = document.createElement ( "li " ) ;
              li. innerHTML = `<span class="tag"> ${targetCode.toUpperCase()} </span> ${text || "-" } ` ;
              列表.appendChild ( li);
            });
            block.appendChild （列表）
 ；
          }

          translationsEl.appendChild (块)
 ;
        });
      }
    </脚本>
  </正文>
</html>
